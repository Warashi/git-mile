# TUI リスクと対策

## 表示レイアウト

- **課題**: 全角・結合文字を含むタイトルやコメントが描画崩れを引き起こす可能性。
- **対策**: `unicode-width` を用いた幅計算と `ratatui` の `Constraint::Length` を組み合わせ、テキストを安全に折り返す。

## セッション遅延

- **課題**: `git mile mcp-server` のレスポンスが遅延した場合、UI が固まって見える。
- **対策**: コマンド実行中はプログレスインジケータを表示し、`tokio::time::timeout` で 10 秒以上の無応答を検知したらキャンセルを提示。

## 接続断復旧

- **課題**: stdio ベースの通信は親プロセス終了やパイプ断で失敗しやすい。
- **対策**: 子プロセス監視を `tokio::process::Child` で行い、`SIGINT` 受信時は Graceful Shutdown を試みる。失敗した場合は再接続オプションを提示。

## ログ肥大化

- **課題**: MCP トレースログを詳細に出力するとファイルサイズが急増する。
- **対策**: 回転ログ (`tracing-appender`) を導入し、UI からログレベルを切り替えられるようにする。

## Windows / ターミナル差異

- **課題**: Windows ConHost や古い Terminfo を利用する環境で入力イベントが欠落する恐れ。
- **対策**: `crossterm` の互換モードを有効にし、既知の制限をドキュメント化。CI に Windows ジョブを追加。

## UX 側のリスク

- **課題**: 一覧・詳細表示のみでは編集系フローが不足し、ユーザーが混乱する可能性。
- **対策**: MVP のスコープを明示しておき、編集やコメント投稿は CLI か他クライアントを利用する旨を UI とドキュメントに提示する。
